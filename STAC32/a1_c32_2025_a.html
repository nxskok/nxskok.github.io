<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAC32 Assignment 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="a1_c32_2025_files/libs/clipboard/clipboard.min.js"></script>
<script src="a1_c32_2025_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="a1_c32_2025_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="a1_c32_2025_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="a1_c32_2025_files/libs/quarto-html/popper.min.js"></script>
<script src="a1_c32_2025_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="a1_c32_2025_files/libs/quarto-html/anchor.min.js"></script>
<link href="a1_c32_2025_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="a1_c32_2025_files/libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="a1_c32_2025_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="a1_c32_2025_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="a1_c32_2025_files/libs/bootstrap/bootstrap-c90fdc7fae47edb01d98fb833718c099.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="a1_c32_2025_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="a1_c32_2025_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STAC32 Assignment 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You are expected to complete this assignment on your own: that is, you may discuss general ideas with others, but the writeup of the work must be entirely your own. If your assignment is unreasonably similar to that of another student, you can expect to be asked to explain yourself.</p>
<p>If you run into problems on this assignment, it is up to you to figure out what to do. The only exception is if it is <em>impossible</em> for you to complete this assignment, for example a data file cannot be read. (There is a difference between you not knowing how to do something, which you have to figure out, and something being impossible, which you are allowed to contact me about.)</p>
<p>You must hand in a rendered document that shows your code, the output that the code produces, and your answers to the questions. This should be a file with <code>.html</code> on the end of its name. There is no credit for handing in your unrendered document (ending in <code>.qmd</code>), because the grader cannot then see whether the code in it runs properly. After you have handed in your file, you should be able to see (in Attempts) what file you handed in, and you should make a habit of checking that you did indeed hand in what you intended to, and that it displays as you expect.</p>
<p>Hint: render your document frequently, and solve any problems as they come up, rather than trying to do so at the end (when you may be close to the due date). If your document will not successfully render, it is because of an error in your code that you will have to find and fix. The error message will tell you <em>where</em> the problem is, but it is up to you to sort out <em>what</em> the problem is.</p>
</section>
<section id="reading-in-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-data">Reading in data</h2>
<p>The questions below ask you to read in and display the data described:</p>
<ol class="example" type="1">
<li>(3 points) The data in <a href="http://ritsokiguess.site/datafiles/bellpepper.csv" class="uri">http://ritsokiguess.site/datafiles/bellpepper.csv</a> come from a study of soil water content of two fields A and B where bell peppers are grown. Read the data into a dataframe and display at least some of it.</li>
</ol>
<p>The easiest one to begin with. This is a <code>.csv</code> file, which you can tell either from the filename, or by opening it in a web browser. The file will probably open in your spreadsheet application, which also gives you a hint that it came from a spreadsheet originally (so it might be a <code>.csv</code> file). Hence, <code>read_csv</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/bellpepper.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>soil <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 30 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): field
dbl (1): water

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>soil</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["field"],"name":[1],"type":["chr"],"align":["left"]},{"label":["water"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"a","2":"10.2"},{"1":"a","2":"10.7"},{"1":"a","2":"15.5"},{"1":"a","2":"10.4"},{"1":"a","2":"9.9"},{"1":"a","2":"10.0"},{"1":"a","2":"16.6"},{"1":"a","2":"15.1"},{"1":"a","2":"15.2"},{"1":"a","2":"13.8"},{"1":"a","2":"14.1"},{"1":"a","2":"11.4"},{"1":"a","2":"11.5"},{"1":"a","2":"11.0"},{"1":"b","2":"8.1"},{"1":"b","2":"8.5"},{"1":"b","2":"8.4"},{"1":"b","2":"7.3"},{"1":"b","2":"8.0"},{"1":"b","2":"7.1"},{"1":"b","2":"13.9"},{"1":"b","2":"12.2"},{"1":"b","2":"13.4"},{"1":"b","2":"11.3"},{"1":"b","2":"12.6"},{"1":"b","2":"12.6"},{"1":"b","2":"12.7"},{"1":"b","2":"12.4"},{"1":"b","2":"11.3"},{"1":"b","2":"12.5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Give your dataframe a descriptive name, like <code>soil</code>. Something like <code>my_data</code> is a <em>bad</em> name, because you (and your reader) will soon forget what it contains.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>You should see a message saying how many rows and columns got read in (in this case 30 rows and 2 columns), along with a description of what the columns were (a text column called <code>field</code> and a quantitative column called <code>water</code> in this case).</p>
<p>The first thing to do after reading in a data file is to look at the dataframe, to make sure the values in it look sensible.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The easiest way to look at your dataframe is simply to put its name on a line by itself in your code chunk. This will display the first ten rows. If you have the <code>df-print: paged</code> thing working properly, your rendered document will then allow your reader to page through your data values to check them. In this case, the field B values start in row 15, so you’ll need to page down to check that they are indeed there.</p>
<p>Another way you might have seen in the course is this one:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(soil)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30
Columns: 2
$ field &lt;chr&gt; "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a",…
$ water &lt;dbl&gt; 10.2, 10.7, 15.5, 10.4, 9.9, 10.0, 16.6, 15.1, 15.2, 13.8, 14.1,…</code></pre>
</div>
</div>
<p>which “transposes” the arrangement so that the variables go down the page and their values go across. Either of these are good here, though just typing the name of the dataframe is usually easier.</p>
<p>Extra: for yourself, you would normally look at your dataframe to check that the values appear to be correct. If you opened the file in your web browser (which may have actually opened it in a spreadsheet), you can physically read through the values to verify that they are correct.</p>
<ol start="2" class="example" type="1">
<li>(3 points) The file <a href="http://ritsokiguess.site/datafiles/d1.txt" class="uri">http://ritsokiguess.site/datafiles/d1.txt</a> contains values for two quantitative variables <code>x</code> and <code>y</code>. Read the data into a dataframe <code>d1</code>, and display the dataframe. (Hint: look at the file with your web browser first.)</li>
</ol>
<p>This time, the <code>.txt</code> on the filename suggests that we have some work to do to figure out what <em>kind</em> of text file we have. If you look at the file, you’ll see that the numeric values of <code>x</code> and <code>y</code>, as well as the variable names themselves, are separated by a colon, so <code>read_delim</code> is called for:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/d1.txt"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">":"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ":"
dbl (2): x, y

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"7","2":"10"},{"1":"9","2":"13"},{"1":"10","2":"14"},{"1":"13","2":"16"},{"1":"14","2":"17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>I told you what to call the dataframe this time. Don’t forget the second input to <code>read_delim</code>, which says what the data values are separated by. This one is a deliberately small dataframe, so that all of it gets displayed.</p>
<p>Extra: now that you have gotten <code>read_delim</code> working, you might be wondering what happens if you leave the delimiter out:<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_delim</span>(my_url)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ":"
dbl (2): x, y

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"7","2":"10"},{"1":"9","2":"13"},{"1":"10","2":"14"},{"1":"13","2":"16"},{"1":"14","2":"17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It actually still works! What happens is that if you don’t supply a delimiter, <code>read_delim</code> tries to guess what it is (since there must be one). In this case, <code>read_delim</code> guessed right (as you can see under “Column specification”) and it worked. However, you won’t always be so lucky.</p>
<p>The safe way is to explicitly say what the delimiter is. Hence, if you choose to omit the delimiter in this course, you <em>must</em> convince your reader that the delimiter was actually gotten correct (otherwise, it looks as if you don’t understand what you are doing).</p>
<ol start="3" class="example" type="1">
<li>(3 points) The file <a href="http://ritsokiguess.site/datafiles/d2.txt" class="uri">http://ritsokiguess.site/datafiles/d2.txt</a> contains values for a categorical variable <code>group</code> and a quantitative variable <code>y</code>. Read the data into a dataframe <code>d2</code>, and display the dataframe.</li>
</ol>
<p>The hint for the previous question should suggest to you that once again, looking at the datafile in your web browser should give you a hint about how to read it in. This time, there are two aligned columns separated by a variable amount of whitespace, which is the sort of thing <code>read_table</code> deals with. You can copy and paste your code from the previous question, but make sure you edit <em>everything</em> that needs editing!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/d2.txt"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  group = col_character(),
  y = col_double()
)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>d2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"low","2":"10"},{"1":"high","2":"7"},{"1":"high","2":"13"},{"1":"low","2":"12"},{"1":"low","2":"6"},{"1":"high","2":"9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="island-birds" class="level2">
<h2 class="anchored" data-anchor-id="island-birds">Island birds</h2>
<p>The data in <a href="http://ritsokiguess.site/datafiles/Sleuth2_ex1027.csv" class="uri">http://ritsokiguess.site/datafiles/Sleuth2_ex1027.csv</a> are information about 62 species of European birds. For each of 16 islands over many years, observers noted whether what species were present on that island, and for each species present, how many breeding pairs of that species there were. The data in that file are averages over the sixteen islands for that species. In addition, a “time to extinction” was also calculated for each species, based on the length of time the species had been seen on each island. A larger time to extinction is better, and it is believed that a species with more breeding pairs will have a larger time to extinction.</p>
<p>As well as the columns <code>Pairs</code> and <code>Time</code> described above, the dataset contains these columns:</p>
<ul>
<li><code>Species</code>: the name of the bird species</li>
<li>the <code>Size</code> of birds in that species: large (<code>L</code>) or small (<code>S</code>)</li>
<li>the <code>Status</code> of the bird species: resident (<code>R</code>), or migratory (<code>M</code>). Resident birds live on the same island all year, while migratory birds spend part of the year in some other part of the world.</li>
</ul>
<ol start="4" class="example" type="1">
<li>(1 point) Read in and display (some of) the data.</li>
</ol>
<p>A <code>.csv</code> file, so:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/Sleuth2_ex1027.csv"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>birds <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 62 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): Species, Size, Status
dbl (2): Time, Pairs

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>birds</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Time"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pairs"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Size"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Status"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Sparrowhawk","2":"3.030","3":"1.000","4":"L","5":"R"},{"1":"Buzzard","2":"5.464","3":"2.000","4":"L","5":"R"},{"1":"Kestrel","2":"4.098","3":"1.210","4":"L","5":"R"},{"1":"Peregrine","2":"1.681","3":"1.125","4":"L","5":"R"},{"1":"Grey partridge","2":"8.850","3":"5.167","4":"L","5":"R"},{"1":"Quail","2":"1.493","3":"1.000","4":"L","5":"M"},{"1":"Red-legged partridge","2":"7.692","3":"2.750","4":"L","5":"R"},{"1":"Pheasant","2":"3.846","3":"5.630","4":"L","5":"R"},{"1":"Water rail","2":"16.667","3":"3.000","4":"L","5":"R"},{"1":"Corncrake","2":"4.219","3":"4.670","4":"L","5":"M"},{"1":"Moorhen","2":"8.130","3":"4.056","4":"L","5":"R"},{"1":"Coot","2":"5.000","3":"1.000","4":"L","5":"R"},{"1":"Lapwing","2":"7.299","3":"6.960","4":"L","5":"M"},{"1":"Golden plover","2":"1.000","3":"1.670","4":"L","5":"M"},{"1":"Ringed plover","2":"27.027","3":"5.560","4":"L","5":"R"},{"1":"Curlew","2":"3.106","3":"2.830","4":"L","5":"M"},{"1":"Redshank","2":"4.000","3":"4.375","4":"L","5":"M"},{"1":"Snipe","2":"16.129","3":"4.125","4":"L","5":"M"},{"1":"Stock dove","2":"3.484","3":"3.670","4":"L","5":"R"},{"1":"Rock dove","2":"37.037","3":"8.330","4":"L","5":"R"},{"1":"Wood pigeon","2":"7.299","3":"2.750","4":"L","5":"R"},{"1":"Cuckoo","2":"2.525","3":"1.430","4":"L","5":"M"},{"1":"Short-eared owl","2":"4.132","3":"2.000","4":"L","5":"R"},{"1":"Little owl","2":"2.000","3":"2.750","4":"L","5":"R"},{"1":"Magpie","2":"10.000","3":"4.500","4":"L","5":"R"},{"1":"Jackdaw","2":"2.667","3":"7.120","4":"L","5":"R"},{"1":"Carrion crow","2":"4.587","3":"4.580","4":"L","5":"R"},{"1":"Raven","2":"58.824","3":"2.350","4":"L","5":"R"},{"1":"Skylark","2":"32.258","3":"6.870","4":"S","5":"R"},{"1":"Swallow","2":"2.571","3":"3.830","4":"S","5":"M"},{"1":"House martin","2":"2.160","3":"5.000","4":"S","5":"M"},{"1":"Yellow wagtail","2":"1.000","3":"1.250","4":"S","5":"M"},{"1":"Pied wagtail","2":"2.967","3":"2.270","4":"S","5":"R"},{"1":"Meadow pipit","2":"9.524","3":"5.350","4":"S","5":"R"},{"1":"Wren","2":"11.111","3":"8.700","4":"S","5":"R"},{"1":"Dunnock","2":"7.299","3":"6.100","4":"S","5":"R"},{"1":"Robin","2":"4.000","3":"3.330","4":"S","5":"R"},{"1":"Stonechat","2":"2.381","3":"3.640","4":"S","5":"R"},{"1":"Wheatear","2":"2.611","3":"4.830","4":"S","5":"M"},{"1":"Blackbird","2":"3.257","3":"4.670","4":"S","5":"R"},{"1":"Song thrush","2":"1.701","3":"1.700","4":"S","5":"R"},{"1":"Mistle thrush","2":"1.795","3":"1.330","4":"S","5":"R"},{"1":"Grasshopper warbler","2":"1.198","3":"1.000","4":"S","5":"M"},{"1":"Sedge warbler","2":"3.185","3":"1.900","4":"S","5":"M"},{"1":"Whitethroat","2":"2.273","3":"4.420","4":"S","5":"M"},{"1":"Willow warbler","2":"1.111","3":"1.250","4":"S","5":"M"},{"1":"Chiffchaff","2":"1.000","3":"1.000","4":"S","5":"M"},{"1":"Goldcrest","2":"1.000","3":"1.000","4":"S","5":"R"},{"1":"Spotted flycatcher","2":"1.230","3":"1.000","4":"S","5":"M"},{"1":"Great tit","2":"6.061","3":"2.500","4":"S","5":"R"},{"1":"Blue tit","2":"3.175","3":"1.500","4":"S","5":"R"},{"1":"Yellowhammer","2":"2.000","3":"2.500","4":"S","5":"R"},{"1":"Reed bunting","2":"5.076","3":"5.630","4":"S","5":"R"},{"1":"Chaffinch","2":"1.934","3":"2.370","4":"S","5":"R"},{"1":"Goldfinch","2":"1.493","3":"1.500","4":"S","5":"R"},{"1":"Redpoll","2":"1.000","3":"1.000","4":"S","5":"R"},{"1":"Linnet","2":"5.102","3":"6.500","4":"S","5":"R"},{"1":"House sparrow","2":"3.003","3":"4.500","4":"S","5":"R"},{"1":"Tree sparrow","2":"1.898","3":"2.170","4":"S","5":"R"},{"1":"Starling","2":"41.667","3":"11.620","4":"S","5":"R"},{"1":"Pied flycatcher","2":"1.000","3":"1.000","4":"S","5":"M"},{"1":"Siskin","2":"1.000","3":"1.000","4":"S","5":"R"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>as ever, giving your dataframe a suitable name, which doesn’t have to be the same as mine, but should be descriptive of what the dataframe contains.</p>
<p>Data source: <code>ex1027</code> from the <code>Sleuth2</code> package.</p>
<ol start="5" class="example" type="1">
<li>(1 point) Below, you will be drawing some graphs. Why is it that the column <code>Species</code> does not feature in any of the graphs?</li>
</ol>
<p><code>Species</code> is an identifier variable: that is to say, it identifies the observations, and is different for each observation, so that it contains nothing to summarize.</p>
<p>Aside: In the old days of R (that is, before the <code>tidyverse</code>), dataframes often had what was called “row names”, and an identifier variable was the sort of thing that would be used for row names. Row names were sort of a column and sort-of not a column, and the people behind the <code>tidyverse</code> didn’t like this kind of ambiguity, so there are no row names in the <code>tidyverse</code>: they are (as here) normal columns that you have to consider how you want to treat them.</p>
<p>Extra: about the only thing you can do graph-wise with an identifier variable is to use it to identify observations on the graph. Later, you’ll be drawing a scatterplot, and on that you can identify, for example, the species with large time to extinction like this:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>birds <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species_name =</span> <span class="fu">ifelse</span>(Time <span class="sc">&gt;</span> <span class="dv">10</span>, Species, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Pairs, <span class="at">y =</span> Time, <span class="at">label =</span> species_name)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>geom_text_repel</code> uses whatever is in <code>label</code> to identify points on the graph (here, which are the names of the species) by putting the text next to the point it belongs to, as best it can. The labelled points here are fairly far apart, so there is no difficulty finding a place to put the labels. However, if I had tried to label the points at the lower left, <code>geom_text_repel</code> would have had a lot more trouble. (The bird species shown are common in Europe.)</p>
<p>The trick I used to label only some of the points was to create a new column <code>species_name</code> that is the name of the species if the extinction time was greater than 10, and blank (empty) otherwise.</p>
<p>For each of the questions below, draw an appropriate graph of (only) the variables named, explaining (very) briefly why it is appropriate, and give a one-sentence interpretation of the most important feature of the graph, in the context of the data. Two points for the graph in each case (justified choice of graph and drawing the graph), and one for interpretation.</p>
<ol start="6" class="example" type="1">
<li>(3 points) Status</li>
</ol>
<p>To decide what kind of graph to draw, figure out whether the variables concerned are categorical or quantitative, and how many of each you have. In this case, <code>Status</code> is categorical, so you need a bar chart (that counts how many time each <code>Status</code> appears):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Status)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are more resident bird species than migratory ones (optionally, about 42 resident ones and about 19 migratory).</p>
<p>Here and below, your interpretation needs to talk about what the variables actually represent (not just the name of the variable). This is because you are writing for a reader who is likely interested in birds more than statistics, and the variable names are a convenience for <em>you</em>, the statistician.</p>
<ol start="7" class="example" type="1">
<li>(3 points) Pairs</li>
</ol>
<p>One quantitative variable, so a histogram. Choose an appropriate number of bins: enough to show the shape, but not so many that you lose a clear picture of the shape. I think 7 or 8 is about right. If the grader thinks you have too few or too many bins (based on how your graph looks), expect to earn less than full credit:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Pairs)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are a few species that are very common (have a lot of breeding pairs). Or, most of the species have less than about 5 breeding pairs.</p>
<p>If you use a term like “skewed to the right”, explain what that means <em>in this context</em> for the benefit of your readers (who, in this case, would be ornithologists rather than statisticians), along the lines of one of the two interpretations I gave above (talking about the long tail of the distribution or its body, respectively).</p>
<ol start="8" class="example" type="1">
<li>(3 points) Pairs and Size</li>
</ol>
<p><code>Pairs</code> is quantitative and <code>Size</code> is categorical, so a boxplot:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Size, <span class="at">y =</span> Pairs)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Large birds tend to have (slightly) more breeding pairs on average than small ones, but the distribution for small birds has greater variability (and an upper outlier).</p>
<p>The main thing on a boxplot is to compare the medians, so make sure you do that.</p>
<ol start="9" class="example" type="1">
<li>(3 points) Pairs and extinction time</li>
</ol>
<p>These variables are both quantitative, so a scatterplot. The latter is response (read the question) so goes on the <span class="math inline">\(y\)</span>-axis:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Pairs, <span class="at">y =</span> Time)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If the number of breeding pairs is larger, then the extinction time is (usually) larger as well.</p>
<p>(A scatterplot is designed to investigate the <em>relationship</em> between two quantitative variables, so make sure you say something about how they are related here. Optionally, add a <code>geom_smooth()</code> to your graph to help with this assessment.)</p>
<ol start="10" class="example" type="1">
<li>(3 points) Size and status</li>
</ol>
<p>Two categorical variables, so a grouped bar chart. Remember the <code>position = "dodge"</code> to put the bars side by side rather than stacked. You’ll have to make a decision about which variable is <code>x</code> and which is <code>fill</code>. You can justifiably do it either way around here, but your choice affects your interpretation:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Size, <span class="at">fill =</span> Status)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Most of the bird species are resident rather than migratory, whether they are large or small. Or, if the species is large, it is likely to be resident, and if it is small, it is <em>also</em> more likely to be resident, and to about the same degree.</p>
<p>(The logic is “if thing on <span class="math inline">\(x\)</span>-axis, then thing in <code>fill</code>.)</p>
<p>Or, put the variables the other way around:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Status, <span class="at">fill =</span> Size)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A slightly larger number of the bird species are small rather than large, and this is true whether the species is migratory or resident. (If the species is migratory, it is slightly more likely to be small, and the same is true if the species is resident.)</p>
<p>You could alternatively see this as “too many categorical variables”, and repeat your bar chart but with facets:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Status)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Size)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>with the same interpretation as my (first) grouped bar chart. Or, again, with <code>x</code> and the facetting variable switched around.</p>
<p>Extra 1: the time a plot like this is interesting<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> is if there is an <em>association</em> between the status of a bird species and its size: for example, if smaller birds also tend to be migratory. That would show up on this kind of graph by one red bar being taller than the blue one, and the other red bar being shorter.</p>
<p>Extra 2: I probably mentioned that I don’t like stacked bars, but I think there is one defensible case: when the bars are scaled to have the same height. This is what <code>position = "fill"</code> does:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Size, <span class="at">fill =</span> Status)) <span class="sc">+</span>        </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>and this provides enough detail to show that out of the large species, slightly more of them are resident than the small species. But the difference is very small, which is why it was hard to see on the side-by-side bars.</p>
<ol start="11" class="example" type="1">
<li>(3 points) Extinction time, pairs, and size</li>
</ol>
<p>Two quantitative variables and one categorical one, so a scatterplot with <code>Size</code> indicated by colour:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Pairs, <span class="at">y =</span> Time, <span class="at">colour =</span> Size)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Large species tend to have a longer extinction time than small ones, regardless of the number of breeding pairs. (This on the basis that the red dots are usually above the blue ones.)</p>
<p>Again, you can optionally add a <code>geom_smooth</code> to your graph:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> Pairs, <span class="at">y =</span> Time, <span class="at">colour =</span> Size)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="a1_c32_2025_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The red and blue smooth trends are mostly upward, and the red one is above the blue one all the way along.</p>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>I am happy with using a disposable name like <code>my_url</code> for the URL of a file, since this is generally used once to read in the data from the file and then never used again. A dataframe, however, is read in from the file and typically used several more times after that, for example to draw a graph or to do an analysis. If re-using <code>my_url</code> bothers you, by all means call this one something like <code>url_soil</code> and the later ones <code>url_d1</code> and <code>url_d2</code>, for example.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>“Garbage in, garbage out” very much applies to data analysis: if your data are wrong, your entire analysis will be nonsense.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>This time, I didn’t save the dataframe in anything, because all I wanted to do was to see whether the reading-in worked, not do anything with the dataframe I read in.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>This one is rather dull.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>